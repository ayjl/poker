extends ./layout

block content
  div.row
    div.small-12.column
      h1 Account Placeholder
      p Current Balance is: <span id='Balance'>#{chips}</span>
      button(class='btn', id='Topup') Top Up Balance (2000)
  div.row
    div.small-12.column
      div#Graph

  
  script(type='text/javascript').  
    $(function() {
      $('#Graph').highcharts({
        credits: {
          enabled: false
        },
        exporting: {
          enabled: false
        },
        title: {
          text: 'Overall lifetime profitability',
          x: -20
        },
        yAxis: {
          title: {
            text: 'Profitability'
          }
        },
        xAxis: {
          title: {
            text: 'Time Played'
          },
          dateTimeLabelFormats: {
            month: '%e. %b',
            year: '%b'
          }
        },
        series: [{
            name: 'Profitability',
            data: [
              [0,0],
              [1,3],
              [2,2]
            ] // need to grab the data and display it
        }]
      });
    });
    $(document).ready(function() {
      $('#Topup').on('click', function() {
        $.ajax( {
          type: 'POST',
          url: '/account/topup-chips',
          data: {
            element: document.getElementById('sessionID')
          },
          success: function(data) {
            $('#Balance').text(data.chips);
          },
          error: function(e) {
            console.log(e.message);
          }
        });
        return false;
      });
    });